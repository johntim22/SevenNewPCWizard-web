<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Software Installation Wizard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
      .step { display: none; }
      .step.active { display: block; }
    </style>
  </head>
  <body>
    <!--navbar here-->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Seven IT Department</a>
        </div>
    </nav>
    <br>

    <!-- Progress bar -->
    <div class="container">
      <div class="progress">
        <div class="progress-bar" role="progressbar" style="width: 0%;" id="progressBar"></div>
      </div>
    </div>
    <br>

    <!-- Form with steps -->
    <div class="container">
      <form id="softwareForm">
        <!-- Welcome Message Step -->
        <div class="step active">
          <fieldset>
            <legend>Welcome to your new computer!</legend>
            <p>This wizard will guide you through selecting and installing the necessary software for your system. Please click "Start" to proceed.</p>
          </fieldset>
        </div>

        <div class="step">
          <fieldset>
            <legend>Basic software</legend>
            <p><i>It is recommended that you install all items from this category! For Foxit PDF Editor please contact the IT Department.</i></p>
            <input type="checkbox" id="brave" name="brave" value="Brave.Brave" checked>
            <label for="brave">Brave Browser</label><br>
            <input type="checkbox" id="360antivirus" name="360antivirus" value="9NBLGGH1NP58" checked>
            <label for="360antivirus">360 Total Security</label><br>
            <input type="checkbox" id="foxitpdf" name="foxitpdf" value="XPFCG5NRKXQPKT">
            <label for="foxitpdf">Foxit PDF Reader</label><br>
            <input type="checkbox" id="winrar" name="winrar" value="RARLab.WinRAR">
            <label for="winrar">WinRAR Archive Manager</label><br>
            <input type="checkbox" id="qbit" name="qbit" value="qBittorrent.qBittorrent">
            <label for="qbit">QBitTorrent Manager</label><br>
            <input type="checkbox" id="python" name="python" value="Python.Python.3.10">
            <label for="python">Python 3.10</label><br>
            <input type="checkbox" id="java" name="java" value="Oracle.JDK.22">
            <label for="java">Java 22 (JDK)</label><br>
            <input type="checkbox" id="net" name="net" value="Microsoft.DotNet.SDK.6">
            <label for="net">Microsoft .NET 6 SDK</label><br>
			<input type="checkbox" id="revo" name="revo" value="RevoUninstaller.RevoUninstaller">
            <label for="revo">Revo Uninstaller</label><br>
			<input type="checkbox" id="everything" name="everything" value="voidtools.Everything">
            <label for="everything">Everything Search</label><br>
          </fieldset>
        </div>

        <div class="step">
          <fieldset>
            <legend>Productivity Tools</legend>
            <p><i>For Microsoft Office please contact the IT Department!</i></p>
            <input type="checkbox" id="powertoys" name="powertoys" value="XP89DCGQ3K6VLD" checked>
            <label for="powertoys">Microsoft PowerToys</label><br>
            <input type="checkbox" id="libreoffice" name="libreoffice" value="TheDocumentFoundation.LibreOffice">
            <label for="libreoffice">LibreOffice</label><br>
			<input type="checkbox" id="obsidian" name="obsidian" value="Obsidian.Obsidian">
            <label for="obsidian">Obsidian</label><br>
			<input type="checkbox" id="evernote" name="evernote" value="Evernote.Evernote">
            <label for="Evernote">Evernote</label><br>
        </div>

        <div class="step">
          <fieldset>
            <legend>Security Tools</legend>
            <input type="checkbox" id="malbytes" name="malbytes" value="Malwarebytes.Malwarebytes" checked>
            <label for="malbytes">Malwarebytes</label><br>
            <input type="checkbox" id="superantispyware" name="superantispyware" value="SUPERAntiSpyware.SUPERAntiSpyware" checked>
            <label for="superantispyware">Super AntiSpyware</label><br>
          </fieldset>
        </div>

        <div class="step">
          <fieldset>
            <legend>Programming Tools (IT and Business/Data Analytics Only)</legend>
            <input type="checkbox" id="intelj" name="intelj" value="JetBrains.IntelliJIDEA.Community">
            <label for="intelj">IntelliJ IDEA IDE for Java</label><br>
            <input type="checkbox" id="pycharm" name="pycharm" value="JetBrains.PyCharm.Community">
            <label for="pycharm">PyCharm IDE for Python</label><br>
            <input type="checkbox" id="vscode" name="vscode" value="Microsoft.VisualStudioCode">
            <label for="vscode">Microsoft Visual Studio Code</label><br>
            <input type="checkbox" id="notepad++" name="notepad++" value="Notepad++.Notepad++">
            <label for="notepad++">Notepad++</label><br>
			<input type="checkbox" id="vim" name="vim" value=" vim.vim">
            <label for="vim">Vim</label><br>
			<input type="checkbox" id="codeblocks" name="codeblocks" value="Codeblocks.Codeblocks">
            <label for="codeblocks">Codeblocks (with C/C++ compiler)</label><br>
			<input type="checkbox" id="git" name="git" value="Git.Git">
            <label for="git">Git</label><br>
			<input type="checkbox" id="github" name="github" value="GitHub.GitHubDesktop">
            <label for="github">GitHub Desktop</label><br>
			<input type="checkbox" id="node" name="node" value="OpenJS.NodeJS">
            <label for="node">Node JS</label><br>
			<input type="checkbox" id="vstudio" name="vstudio" value="Microsoft.VisualStudio.2022.Community">
            <label for="vstudio">Microsoft Visual Studio 2022</label><br>
			<input type="checkbox" id="atom" name="atom" value="github.atom">
            <label for="atom">Atom (Text Editor)</label><br>
          </fieldset>
        </div>

        <div class="step">
          <fieldset>
            <legend>Data Analytics Tools (Data/Business Analytics Only)</legend>
            <p><i>For Alteryx and Tableau please contact the HR Department!</i></p>
            <input type="checkbox" id="r" name="r" value="RProject.R">
            <label for="r">R Programming Language</label><br>
            <input type="checkbox" id="rstudio" name="rstudio" value="Posit.RStudio">
            <label for="rstudio">R Studio</label><br>
            <input type="checkbox" id="KNIME" name="KNIME" value="KNIMEAG.KNIMEAnalyticsPlatform">
            <label for="KNIME">KNIME Data Analytics</label><br>
            <input type="checkbox" id="PowerBI" name="PowerBI" value="Microsoft.PowerBI">
            <label for="PowerBI">Microsoft PowerBI</label><br>
          </fieldset>
        </div>
		
		<div class="step">
          <fieldset>
            <legend>GIS Tools (Logistics Only)</legend>
            <input type="checkbox" id="googleearth" name="googleearth" value="Google.EarthPro">
            <label for="googleearth">Google Earth Pro</label><br>
          </fieldset>
        </div>

        <div class="step">
          <fieldset>
            <legend>Messaging Tools</legend>
            <input type="checkbox" id="skype" name="skype" value="9WZDNCRFJ364">
            <label for="skype">Skype</label><br>
            <input type="checkbox" id="zoom" name="zoom" value="XP99J3KP4XZ4VV">
            <label for="zoom">Zoom Workspace</label><br>
            <input type="checkbox" id="discord" name="discord" value="XPDC2RH70K22MN">
            <label for="discord">Discord</label><br>
            <input type="checkbox" id="msteams" name="msteams" value="XP8BT8DW290MPQ">
            <label for="msteams">Microsoft Teams</label><br>
			<input type="checkbox" id="telegram" name="telegram" value="Telegram.TelegramDesktop">
            <label for="telegram">Telegram</label><br>
			<input type="checkbox" id="whatsapp" name="whatsapp" value="9NKSQGP7F2NH">
            <label for="whatsapp">WhatsApp</label><br>
			<input type="checkbox" id="viber" name="viber" value="Rakuten.Viber">
            <label for="viber">Viber</label><br>
          </fieldset>
        </div>
		
		<div class="step">
			<fieldset>
				<legend>System Personalization</legend>
				<input type="checkbox" id="winaero" name="winaero" value="winaero.tweaker">
				<label for="winaero">Winaero Tweaker</label><br>
			</fieldset>
		</div>

        <div class="step">
            <fieldset>
              <legend>All set! Enjoy your new computer!</legend>
              <p>Your choices have been recorded. Click finish and then download and run the installer file! All the software you selected will get installed automatically!</p><br>
			  <p>More software choices will be available after the completion of this this phase!</p>
            </fieldset>
          </div>

        <!-- Navigation buttons -->
         <br><br>
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary" id="prevBtn" onclick="nextPrev(-1)">Back</button>
          <button type="button" class="btn btn-primary" id="nextBtn" onclick="nextPrev(1)">Next</button>
        </div>
      </form>
    </div>

    <script>
      let currentStep = 0;
      const steps = document.getElementsByClassName("step");
      const progressBar = document.getElementById("progressBar");

      function showStep(n) {
        steps[n].classList.add("active");
        updateProgressBar(n);
        // Update button text for last step
        if (n === steps.length - 1) {
          document.getElementById("nextBtn").textContent = "Finish";
        } else if (n === 0) {
          document.getElementById("nextBtn").textContent = "Start";
        } else {
          document.getElementById("nextBtn").textContent = "Next";
        }
        // Hide/show prev button
        if (n === 0) {
          document.getElementById("prevBtn").style.display = "none";
        } else {
          document.getElementById("prevBtn").style.display = "inline";
        }
      }

      function nextPrev(n) {
        // Exit if current form step is not valid
        if (n === 1 && !validateForm()) return false;
        // Hide current step
        steps[currentStep].classList.remove("active");
        // Change step
        currentStep += n;
        // If the user is at the last step
        if (currentStep >= steps.length) {
          generateBatFile();
          return false;
        }
        // Otherwise, display the correct step
        showStep(currentStep);
      }

      function validateForm() {
        // Perform form validation here if necessary
        return true;
      }

      function updateProgressBar(n) {
        const progress = ((n + 1) / steps.length) * 100;
        progressBar.style.width = progress + "%";
      }

      // Initial display of the first step
      showStep(currentStep);

      function generateBatFile() {
        // Collect selected checkboxes
        let selectedSoftware = [];
        let checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
        checkboxes.forEach(function(checkbox) {
            selectedSoftware.push(checkbox.value);
        });

        if (selectedSoftware.length === 0) {
            alert("Please select at least one software.");
            return;
        }

        // Generate the .bat file content
        let batContent = selectedSoftware.map(software => `winget install ${software}`).join("\n");

        // Create a Blob with the batContent and create a download link
        let blob = new Blob([batContent], { type: "text/plain" });
        let link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "install_software.bat";

        // Append the link, trigger the download, and remove the link
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>